## 2.1 介绍

贝叶斯决策理论是模式分类问题的一种基本统计学方法。这个方法采用概率和有关决策的代价分析，并量化各种分类决策的权衡利弊。它假设所有决策问题由概率理论产生，并且所有相关的概率值都已知。

假设 w 为自然状态，w = w1 代表是海鲈鱼，w = w2 代表是鲑鱼。
P(w1) 代表下条鱼是海鲈鱼的概率，P(w2) 代表下条鱼是鲑鱼的概率。
那么决策规则为：如果 P(w1) > P(w2)，就认为下条鱼是海鲈鱼。但是这个规则依赖于先验概率的值。对于很多鱼的判断，结果总是倾向于一方。

另设亮度的值为 x，x 显然为连续随机变量。
用条件概率密度函数 p(x|w1) 和 p(x|w2) 可以代表海鲈鱼和鲑鱼的亮度分布状况，如图2.1所示。

![图2.1](https://yg-1255660153.cos.ap-chengdu.myqcloud.com/PatternClassification/F02.01.jpg)
> 图2.1

假设先验概率 P(wj) 和条件概率密度 p(x|wj) 都已知，实际测量的一条鱼的亮度为 x。
根据联合概率密度，我们有如下公式：
p(wj, x) = P(wj|x)p(x) = p(x|wj)P(wj)，
于是有贝叶斯公式：
P(wj|x) = p(x|wj)P(wj) / p(x)，即“后验概率” = “似然” * “先验概率” / “证据”。
在鱼分类的例子中，
p(x) = Σ(j=1, 2)p(x|wj)P(wj)。

贝叶斯公式意味着给定 x 的观测值，我们就能把先验概率 P(wj) 转化为后验概率 P(wj|x)，即给定 x 时该样本为 wj 的具体概率。把 p(x|wj) 称为 wj 关于 x 的似然，证据因子 p(x) 可以看作保证后验概率之和为 1 的因子。
如图2.2所示，P(wj|x) 关于 x 的分布，条件为 P(w1) = 2/3，P(w2) = 1/3。

![图2.2](https://yg-1255660153.cos.ap-chengdu.myqcloud.com/PatternClassification/F02.02.jpg)
> 图2.2

如果我们对于一个观测值 x 有 P(w1|x) > P(w2|x)，那么我们自然会认为该样本的真实值为 w1。据此，我们可以定义做出决策时的错误概率：
P(error|x) = { P(w1|x), 如果决策为w2; P(w2|x), 如果决策为w1. }
显然当我们根据上述规则做出决策时会最小化错误概率。
错误概率还可写为：
P(error|x) = min{ P(w1|x), P(w2|x) }。
用贝叶斯公式替换并消去证据因子，得到等价的决策规则：
选择 w1 如果 p(x|w1)P(w1) > p(x|w2)P(w2)；否则选择 w2。

总的来说，贝叶斯公式将先验概率与概率分布结合起来，做出最后决策，并使得出错概率最小化。